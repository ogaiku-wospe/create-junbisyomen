# 階層的フォルダ構造への移行 - クイックスタート

## TL;DR（要約）

新しい階層的フォルダ構造により、甲号証と乙号証が最初から分離管理されます。

```
旧: 事件/未分類/（甲・乙混在）
新: 事件/甲号証/未分類/ + 事件/乙号証/未分類/
```

---

## ステップ1: ドライラン（5分）

変更内容を確認します（実際には何も変更されません）：

```bash
cd /home/user/webapp
python3 migrate_to_hierarchical_folders.py
```

**確認事項:**
- ✅ 新しいフォルダ構造が表示される
- ✅ 移動するファイルのリストが表示される
- ✅ 証拠種別の自動判定結果を確認

---

## ステップ2: 実行（10-15分）

問題がなければ実際に移行します：

```bash
python3 migrate_to_hierarchical_folders.py --execute
```

**自動実行される処理:**
1. 階層的フォルダ構造を作成
2. ファイルを適切なフォルダに移動
3. 仮番号をリネーム（tmp_001 → tmp_ko_001）
4. database.jsonを更新

---

## ステップ3: 確認（5分）

Google Driveで以下を確認：

```
事件フォルダ/
├── 甲号証/
│   ├── 確定済み/ ← ko001, ko002が移動済み
│   ├── 整理済み_未確定/ ← tmp_ko_001, tmp_ko_002が移動済み
│   └── 未分類/ ← 未整理ファイルが移動済み
└── 乙号証/
    ├── 確定済み/ ← otsu001, otsu002が移動済み
    ├── 整理済み_未確定/ ← tmp_otsu_001が移動済み
    └── 未分類/ ← 未整理ファイルが移動済み
```

---

## よくある質問

### Q: 移行は必須ですか？
**A:** いいえ。既存事件は旧形式のまま動作します。新規事件のみ自動的に新形式になります。

### Q: 失敗したらどうなりますか？
**A:** Google Driveのゴミ箱からファイルを復元できます。必ずドライランで確認してから実行してください。

### Q: 証拠種別が間違っている場合は？
**A:** 移行前にファイル名に`otsu`や`乙`を含めておくと、自動判定が正確になります。

---

## 注意事項

⚠️ **移行前に必ず実施:**
1. ドライランで内容を確認
2. Google Driveのバックアップ（可能であれば）
3. 重要なファイルのローカルコピー

⚠️ **移行中は:**
- 他の操作を行わない
- インターネット接続を維持
- 処理完了まで待つ（10-15分程度）

⚠️ **移行後は:**
- フォルダ構造を確認
- 証拠リストを表示して確認
- テスト的に証拠整理を実行

---

## サポート

問題が発生した場合:
1. エラーメッセージをスクリーンショット
2. 実行したコマンドを記録
3. `HIERARCHICAL_FOLDERS.md`のトラブルシューティングを参照

---

## 次のステップ

移行完了後:

1. **証拠をアップロード**
   - 甲号証 → `事件/甲号証/未分類/`
   - 乙号証 → `事件/乙号証/未分類/`

2. **証拠を整理**
   ```bash
   python3 run_phase1_multi.py
   # メニューから証拠種別を選択
   ```

3. **証拠リストを確認**
   - メニューから「証拠一覧を表示」を選択
   - 証拠種別ごとに分離されて表示される

---

Happy organizing! 📁✨
