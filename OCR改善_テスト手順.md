# âŒ OCRæ”¹å–„ãŒé©ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“ - å¯¾å¿œæ‰‹é †

## ğŸ” å•é¡Œã®è¨ºæ–­çµæœ

ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸ`database (21).json`ã‚’åˆ†æã—ãŸçµæœã€**OCRæ”¹å–„ãŒå…¨ãé©ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“**ã€‚

### ç¢ºèªã•ã‚ŒãŸå•é¡Œ

```json
{
  "tmp_ko_004": {
    "full_content": {},  // â† ç©ºï¼
    "è¨¼æ‹ ã®èª¬æ˜": "",     // â† ç©ºï¼
    "ç·æ–‡å­—æ•°": 0,        // â† ã‚¼ãƒ­ï¼
    "ãƒšãƒ¼ã‚¸åˆ¥ãƒ†ã‚­ã‚¹ãƒˆ": [] // â† ç©ºï¼
  }
}
```

**ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ç¢ºèª**:
```json
"last_updated": "2025-11-06T14:25:04.078610"
```
â†’ ã“ã‚Œã¯OCRæ”¹å–„ã‚³ãƒŸãƒƒãƒˆï¼ˆbef6ac1ï¼‰ã®**å‰**ã§ã™

---

## ğŸš€ è§£æ±ºæ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: æœ€æ–°ã‚³ãƒ¼ãƒ‰ã®å–å¾—

```bash
cd /path/to/create-junbisyomen

# ç¾åœ¨ã®ãƒ–ãƒ©ãƒ³ãƒã‚’ç¢ºèª
git branch

# genspark_ai_developerãƒ–ãƒ©ãƒ³ãƒã«åˆ‡ã‚Šæ›¿ãˆ
git checkout genspark_ai_developer

# æœ€æ–°ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
git pull origin genspark_ai_developer
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```
Updating eb1cd1e..bef6ac1
Fast-forward
 src/ai_analyzer_complete.py   | 8 ++++----
 src/ai_analyzer_stepwise.py   | 34 +++++++++++++++++++++++++++-------
 OCR_IMPROVEMENTS_SUMMARY.md   | 268 ++++++++++++++++++++++++++++
 3 files changed, 299 insertions(+), 11 deletions(-)
```

### ã‚¹ãƒ†ãƒƒãƒ—2: æœ€æ–°ã‚³ãƒŸãƒƒãƒˆã®ç¢ºèª

```bash
# æœ€æ–°ã‚³ãƒŸãƒƒãƒˆã‚’ç¢ºèª
git log --oneline -5
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```
bef6ac1 docs: Add comprehensive OCR improvements summary in Japanese
eb1cd1e feat: Implement step-wise JSON generation system with improved OCR accuracy
...
```

**é‡è¦**: `bef6ac1`ã¾ãŸã¯`eb1cd1e`ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼

### ã‚¹ãƒ†ãƒƒãƒ—3: Pythonã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã‚¯ãƒªã‚¢ï¼ˆé‡è¦ï¼ï¼‰

```bash
# __pycache__ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å…¨ã¦å‰Šé™¤
find . -type d -name '__pycache__' -exec rm -r {} + 2>/dev/null

# .pycãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¨ã¦å‰Šé™¤
find . -type f -name '*.pyc' -delete

# ç¢ºèª
echo "ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Œäº†"
```

### ã‚¹ãƒ†ãƒƒãƒ—4: ã‚³ãƒ¼ãƒ‰ã®ç¢ºèª

æ”¹å–„ãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª:

```bash
# DPIè¨­å®šã‚’ç¢ºèªï¼ˆ300ã§ã‚ã‚‹ã¹ãï¼‰
grep "dpi=300" src/ai_analyzer_complete.py
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```python
dpi=300  # è§£åƒåº¦ã‚’150â†’300ã«å‘ä¸Šï¼ˆOCRç²¾åº¦æ”¹å–„ï¼‰
```

```bash
# max_tokensã‚’ç¢ºèªï¼ˆ4096ã§ã‚ã‚‹ã¹ãï¼‰
grep "max_tokens=4096" src/ai_analyzer_stepwise.py
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```python
result = self._call_claude_vision(image_path, prompt, max_tokens=4096)
```

### ã‚¹ãƒ†ãƒƒãƒ—5: tmp_ko_004ã‚’å†åˆ†æ

```bash
# è¤‡æ•°è¨¼æ‹ åˆ†æã‚’å®Ÿè¡Œ
python3 run_phase1_multi.py
```

**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ“ä½œ**:
1. äº‹ä»¶ã‚’é¸æŠ
2. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ã€Œ1. å€‹åˆ¥è¨¼æ‹ ã‚’åˆ†æã€ã‚’é¸æŠ
3. è¨¼æ‹ ãƒªã‚¹ãƒˆã‹ã‚‰ã€Œtmp_ko_004ã€ã‚’é¸æŠï¼ˆã¾ãŸã¯ç•ªå·ã‚’å…¥åŠ›ï¼‰
4. åˆ†æå®Œäº†ã‚’å¾…ã¤

### ã‚¹ãƒ†ãƒƒãƒ—6: ãƒ­ã‚°å‡ºåŠ›ã‚’ç¢ºèª

åˆ†æä¸­ã€ä»¥ä¸‹ã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª:

#### âœ… ç”»åƒå“è³ªãƒ­ã‚°ï¼ˆDPI 300ï¼‰
```
ğŸ“· ãƒšãƒ¼ã‚¸1ç”»åƒ: tmp_ko_004_page1_abc123.jpg
   ã‚µã‚¤ã‚º: 2480x3508px, 850,234 bytes, JPEGå“è³ª95%
ğŸ“· ãƒšãƒ¼ã‚¸2ç”»åƒ: tmp_ko_004_page2_abc123.jpg
   ã‚µã‚¤ã‚º: 2480x3508px, 820,156 bytes, JPEGå“è³ª95%
ğŸ“· ãƒšãƒ¼ã‚¸3ç”»åƒ: tmp_ko_004_page3_abc123.jpg
   ã‚µã‚¤ã‚º: 2480x3508px, 780,942 bytes, JPEGå“è³ª95%
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:
- è§£åƒåº¦ãŒ2000pxä»¥ä¸Šï¼ˆé«˜è§£åƒåº¦ï¼‰
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒ500KBä»¥ä¸Šï¼ˆé«˜å“è³ªï¼‰
- JPEGå“è³ª95%è¡¨ç¤º

#### âœ… æ®µéšçš„åˆ†æãƒ­ã‚°
```
ğŸ¯ æ®µéšçš„åˆ†æé–‹å§‹: tmp_ko_004 (3ãƒšãƒ¼ã‚¸)
ğŸ“Š [1/6] ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
   âœ… ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºå®Œäº†: 250æ–‡å­—
ğŸ“„ [2/6] OCRãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º
   ğŸ“„ ãƒšãƒ¼ã‚¸1ã®OCRå®Ÿè¡Œä¸­...
   âœ… ãƒšãƒ¼ã‚¸1å®Œäº†: 450æ–‡å­—
   ğŸ“„ ãƒšãƒ¼ã‚¸2ã®OCRå®Ÿè¡Œä¸­...
   âœ… ãƒšãƒ¼ã‚¸2å®Œäº†: 680æ–‡å­—  â† é‡è¦ï¼
   ğŸ“„ ãƒšãƒ¼ã‚¸3ã®OCRå®Ÿè¡Œä¸­...
   âœ… ãƒšãƒ¼ã‚¸3å®Œäº†: 520æ–‡å­—
   âœ… OCRãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡ºå®Œäº†: 1650æ–‡å­—ï¼ˆ3ãƒšãƒ¼ã‚¸ï¼‰
ğŸ“‹ [3/6] æ–‡æ›¸å†…å®¹åˆ†æ
   âœ… æ–‡æ›¸å†…å®¹åˆ†æå®Œäº†: æ–‡æ›¸ã‚¿ã‚¤ãƒ—=é…é”è¨¼æ˜
âš–ï¸ [4/6] æ³•çš„æ„ç¾©æŠ½å‡º
   âœ… æ³•çš„æ„ç¾©æŠ½å‡ºå®Œäº†
ğŸ” [5/6] é–¢é€£äº‹å®ŸæŠ½å‡º
   âœ… é–¢é€£äº‹å®ŸæŠ½å‡ºå®Œäº†
ğŸ”— [6/6] æœ€çµ‚çµ±åˆ
   âœ… æœ€çµ‚çµ±åˆå®Œäº†
ğŸ‰ æ®µéšçš„åˆ†æå®Œäº†: tmp_ko_004
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:
- å…¨6ã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã—ã¦ã„ã‚‹
- ãƒšãƒ¼ã‚¸2ã®æ–‡å­—æ•°ãŒ500æ–‡å­—ä»¥ä¸Šï¼ˆä»¥å‰ã¯0-50æ–‡å­—ã ã£ãŸï¼‰
- ç·æ–‡å­—æ•°ãŒ1500æ–‡å­—ä»¥ä¸Š

#### âŒ ã‚‚ã—å¤ã„ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆ

ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã€**ã‚³ãƒ¼ãƒ‰ãŒæ›´æ–°ã•ã‚Œã¦ã„ã¾ã›ã‚“**:

```
ğŸ“· ãƒšãƒ¼ã‚¸1ç”»åƒ: tmp_ko_004_page1_abc123.jpg (150,234 bytes)
   â† ã‚µã‚¤ã‚ºæƒ…å ±ã®ã¿ã€è§£åƒåº¦ãªã— = å¤ã„ã‚³ãƒ¼ãƒ‰
```

ã¾ãŸã¯:

```
ğŸ¤– [3/5] AIåˆ†æå®Ÿè¡Œ
   â† 5ã‚¹ãƒ†ãƒƒãƒ—ã®ã¿ = æ®µéšçš„åˆ†æãŒç„¡åŠ¹
```

â†’ ã‚¹ãƒ†ãƒƒãƒ—1-3ã‚’å†åº¦å®Ÿè¡Œã—ã¦ãã ã•ã„

### ã‚¹ãƒ†ãƒƒãƒ—7: çµæœã®ç¢ºèª

```bash
# database.jsonã‚’ç¢ºèª
python3 -c "
import json

with open('database.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

for evidence in data.get('evidence', []):
    if evidence.get('evidence_id') == 'tmp_ko_004':
        full_content = evidence.get('full_content', {})
        total_chars = full_content.get('ç·æ–‡å­—æ•°', 0)
        pages = full_content.get('ãƒšãƒ¼ã‚¸åˆ¥ãƒ†ã‚­ã‚¹ãƒˆ', [])
        
        print(f'ç·æ–‡å­—æ•°: {total_chars}')
        print(f'ãƒšãƒ¼ã‚¸æ•°: {len(pages)}')
        
        for page in pages:
            page_num = page.get('page', 0)
            char_count = page.get('char_count', 0)
            print(f'  ãƒšãƒ¼ã‚¸{page_num}: {char_count}æ–‡å­—')
        
        if total_chars >= 1500 and len(pages) == 3:
            print('\nâœ… OCRæ”¹å–„ãŒé©ç”¨ã•ã‚Œã¦ã„ã¾ã™ï¼')
        else:
            print('\nâŒ OCRæ”¹å–„ãŒé©ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“')
            print('   ã‚¹ãƒ†ãƒƒãƒ—1-6ã‚’å†åº¦ç¢ºèªã—ã¦ãã ã•ã„')
        
        break
"
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›**:
```
ç·æ–‡å­—æ•°: 1650
ãƒšãƒ¼ã‚¸æ•°: 3
  ãƒšãƒ¼ã‚¸1: 450æ–‡å­—
  ãƒšãƒ¼ã‚¸2: 680æ–‡å­—
  ãƒšãƒ¼ã‚¸3: 520æ–‡å­—

âœ… OCRæ”¹å–„ãŒé©ç”¨ã•ã‚Œã¦ã„ã¾ã™ï¼
```

---

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q1: git pullã§ã€ŒAlready up to dateã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹

**åŸå› **: ãƒ­ãƒ¼ã‚«ãƒ«ã¨ãƒªãƒ¢ãƒ¼ãƒˆãŒåŒæœŸã•ã‚Œã¦ã„ãªã„

**è§£æ±ºç­–**:
```bash
# ãƒªãƒ¢ãƒ¼ãƒˆã®æœ€æ–°æƒ…å ±ã‚’å–å¾—
git fetch origin

# ç¾åœ¨ã®ã‚³ãƒŸãƒƒãƒˆã‚’ç¢ºèª
git log --oneline -1

# bef6ac1ã§ãªã„å ´åˆ
git reset --hard origin/genspark_ai_developer
```

### Q2: Pythonã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ®‹ã£ã¦ã„ã‚‹æ°—ãŒã™ã‚‹

**è§£æ±ºç­–**:
```bash
# ã‚ˆã‚Šå¼·åŠ›ãªã‚¯ãƒªã‚¢
find . -type d -name '__pycache__' | xargs rm -rf
find . -type f -name '*.pyc' | xargs rm -f
find . -type d -name '*.egg-info' | xargs rm -rf

# Pythonã‚’å†èµ·å‹•ã—ã¦ç¢ºèª
python3 -c "import src.ai_analyzer_complete; print(src.ai_analyzer_complete.__file__)"
```

### Q3: ã€Œæ®µéšçš„åˆ†æé–‹å§‹ã€ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› **: `anthropic`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¾ãŸã¯å¤ã„

**è§£æ±ºç­–**:
```bash
pip3 install --upgrade anthropic
pip3 show anthropic
```

æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›: `Version: 0.39.0`ä»¥ä¸Š

### Q4: ã‚¨ãƒ©ãƒ¼ã€ŒNo module named 'src.ai_analyzer_stepwise'ã€

**åŸå› **: æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«`ai_analyzer_stepwise.py`ãŒå­˜åœ¨ã—ãªã„

**è§£æ±ºç­–**:
```bash
# ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
ls -la src/ai_analyzer_stepwise.py

# ãªã‘ã‚Œã°git pullã‚’å†å®Ÿè¡Œ
git pull origin genspark_ai_developer --force
```

### Q5: ãƒšãƒ¼ã‚¸2ã®æ–‡å­—æ•°ãŒä¾ç„¶ã¨ã—ã¦å°‘ãªã„ï¼ˆ<50æ–‡å­—ï¼‰

**åŸå› 1**: PDFãƒ•ã‚¡ã‚¤ãƒ«è‡ªä½“ã«å•é¡ŒãŒã‚ã‚‹å¯èƒ½æ€§
**åŸå› 2**: Claude APIã‚­ãƒ¼ã®åˆ¶é™

**è§£æ±ºç­–**:
```bash
# PDFã®å†…å®¹ã‚’ç›´æ¥ç¢ºèª
python3 -c "
import PyPDF2
with open('tmp_ko_004_10.pdf', 'rb') as f:
    reader = PyPDF2.PdfReader(f)
    print(f'ãƒšãƒ¼ã‚¸æ•°: {len(reader.pages)}')
    for i, page in enumerate(reader.pages, 1):
        text = page.extract_text()
        print(f'ãƒšãƒ¼ã‚¸{i}: {len(text)}æ–‡å­—')
        if len(text) < 50:
            print(f'  â†’ ç”»åƒãƒ™ãƒ¼ã‚¹ãƒšãƒ¼ã‚¸ï¼ˆOCRå¿…é ˆï¼‰')
"
```

---

## ğŸ“Š æ”¹å–„å‰å¾Œã®æ¯”è¼ƒ

### æ”¹å–„å‰ï¼ˆdatabase (21).jsonï¼‰
```
ç·æ–‡å­—æ•°: 0
ãƒšãƒ¼ã‚¸æ•°: 0
full_content: {}
```

### æ”¹å–„å¾Œï¼ˆæœŸå¾…å€¤ï¼‰
```
ç·æ–‡å­—æ•°: 1650+
ãƒšãƒ¼ã‚¸æ•°: 3
ãƒšãƒ¼ã‚¸1: 450æ–‡å­—ï¼ˆé…é”è¨¼æ˜ãƒ˜ãƒƒãƒ€ãƒ¼ï¼‰
ãƒšãƒ¼ã‚¸2: 680æ–‡å­—ï¼ˆæœ¬æ–‡ - ç”»åƒãƒ™ãƒ¼ã‚¹ï¼‰â† æœ€ã‚‚é‡è¦ï¼
ãƒšãƒ¼ã‚¸3: 520æ–‡å­—ï¼ˆå·®å‡ºäººãƒ»å—å–äººè©³ç´°ï¼‰
```

---

## ğŸ“ ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] `git pull`ã§æœ€æ–°ã‚³ãƒ¼ãƒ‰å–å¾—å®Œäº†
- [ ] æœ€æ–°ã‚³ãƒŸãƒƒãƒˆ`bef6ac1`ã¾ãŸã¯`eb1cd1e`ã‚’ç¢ºèª
- [ ] Pythonã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢å®Œäº†
- [ ] DPI=300è¨­å®šã‚’ç¢ºèª
- [ ] max_tokens=4096è¨­å®šã‚’ç¢ºèª
- [ ] tmp_ko_004ã‚’å†åˆ†æå®Ÿè¡Œ
- [ ] ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã§ã€Œæ®µéšçš„åˆ†æé–‹å§‹ã€ã‚’ç¢ºèª
- [ ] ç”»åƒå“è³ªãƒ­ã‚°ï¼ˆè§£åƒåº¦ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼‰ã‚’ç¢ºèª
- [ ] OCRæ–‡å­—æ•°ãƒ­ã‚°ã§1500æ–‡å­—ä»¥ä¸Šã‚’ç¢ºèª
- [ ] database.jsonã§çµæœã‚’ç¢ºèª
- [ ] ãƒšãƒ¼ã‚¸2ã®æ–‡å­—æ•°ãŒ500æ–‡å­—ä»¥ä¸Šã‚’ç¢ºèª

**å…¨ã¦ãƒã‚§ãƒƒã‚¯å®Œäº†å¾Œ**: 

âœ… OCRæ”¹å–„ãŒæ­£å¸¸ã«é©ç”¨ã•ã‚Œã¦ã„ã¾ã™ï¼

âŒ ä¸€éƒ¨ãƒã‚§ãƒƒã‚¯å¤±æ•—: ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§

---

## ğŸ’¬ ãã‚Œã§ã‚‚å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆ

ä»¥ä¸‹ã®æƒ…å ±ã‚’æä¾›ã—ã¦ãã ã•ã„:

1. **git logå‡ºåŠ›**:
   ```bash
   git log --oneline -5
   ```

2. **ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª**:
   ```bash
   ls -la src/ai_analyzer_stepwise.py
   head -20 src/ai_analyzer_stepwise.py
   ```

3. **å®Ÿè¡Œãƒ­ã‚°**ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«å…¨å‡ºåŠ›ï¼‰

4. **database.jsonã®è©²å½“éƒ¨åˆ†**ï¼ˆtmp_ko_004ã‚¨ãƒ³ãƒˆãƒªï¼‰

ã“ã‚Œã‚‰ã®æƒ…å ±ãŒã‚ã‚Œã°ã€ã‚ˆã‚Šå…·ä½“çš„ãªã‚µãƒãƒ¼ãƒˆãŒå¯èƒ½ã§ã™ã€‚

---

**ä½œæˆæ—¥**: 2025-11-06  
**å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: bef6ac1ä»¥é™  
**å¯¾è±¡ãƒ–ãƒ©ãƒ³ãƒ**: genspark_ai_developer
