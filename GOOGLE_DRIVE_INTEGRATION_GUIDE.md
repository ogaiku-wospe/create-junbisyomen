# Phase 1å®Œå…¨ç‰ˆã‚·ã‚¹ãƒ†ãƒ  - Google Driveé€£æºã®è©³ç´°èª¬æ˜

## ğŸ“‹ ç›®æ¬¡

1. [Google Driveé€£æºã®æ¦‚è¦](#google-driveé€£æºã®æ¦‚è¦)
2. [å…¥åŠ›æƒ…å ±](#å…¥åŠ›æƒ…å ±)
3. [å‡ºåŠ›æƒ…å ±](#å‡ºåŠ›æƒ…å ±)
4. [èªè¨¼ã®ä»•çµ„ã¿](#èªè¨¼ã®ä»•çµ„ã¿)
5. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
6. [ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ](#ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ )
7. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)

---

## ğŸ”— Google Driveé€£æºã®æ¦‚è¦

Phase 1å®Œå…¨ç‰ˆã‚·ã‚¹ãƒ†ãƒ ã¯ã€Google Driveã¨ä»¥ä¸‹ã®æ–¹æ³•ã§é€£æºã—ã¾ã™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Google Drive                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å…±æœ‰ãƒ‰ãƒ©ã‚¤ãƒ– ã¾ãŸã¯ å€‹äººãƒ‰ãƒ©ã‚¤ãƒ–                      â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ äº‹ä»¶ãƒ•ã‚©ãƒ«ãƒ€/                                    â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ ç”²å·è¨¼ãƒ•ã‚©ãƒ«ãƒ€/                              â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â”œâ”€â”€ ko62.pdf                                â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â”œâ”€â”€ ko63.jpg                                â”‚  â”‚
â”‚  â”‚  â”‚   â”‚   â””â”€â”€ ko64.docx                               â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ ä¹™å·è¨¼ãƒ•ã‚©ãƒ«ãƒ€/ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)                 â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€â”€ database.json (è‡ªå‹•ä¿å­˜)                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†•ï¸  APIé€£æº
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Phase 1å®Œå…¨ç‰ˆã‚·ã‚¹ãƒ†ãƒ  (ãƒ­ãƒ¼ã‚«ãƒ«PC)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1. èªè¨¼ (credentials.json + token.json)            â”‚  â”‚
â”‚  â”‚  2. ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰                        â”‚  â”‚
â”‚  â”‚  3. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºãƒ»AIåˆ†æ                           â”‚  â”‚
â”‚  â”‚  4. database.jsonä½œæˆ                                â”‚  â”‚
â”‚  â”‚  5. database.jsonè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— (Google Drive)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¥ å…¥åŠ›æƒ…å ±ï¼ˆGoogle Drive â†’ ã‚·ã‚¹ãƒ†ãƒ ï¼‰

### 1. è¨­å®šæƒ…å ±ï¼ˆconfig.pyï¼‰

ã‚·ã‚¹ãƒ†ãƒ ãŒ**Google Driveã‹ã‚‰èª­ã¿å–ã‚‹**ãŸã‚ã«å¿…è¦ãªæƒ…å ±ï¼š

```python
# config.py ã§è¨­å®š
SHARED_DRIVE_ID = "0AO6q4_G7DmYSUk9PVA"  # å…±æœ‰ãƒ‰ãƒ©ã‚¤ãƒ–IDï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
CASE_FOLDER_ID = "1uux0sGt8j3EUI08nOFkBre_99jR8sN-a"  # äº‹ä»¶ãƒ•ã‚©ãƒ«ãƒ€ID
KO_EVIDENCE_FOLDER_ID = "1NkwibbiUTzaznJGtF0kvsxFER3t62ZMx"  # ç”²å·è¨¼ãƒ•ã‚©ãƒ«ãƒ€ID
OTSU_EVIDENCE_FOLDER_ID = None  # ä¹™å·è¨¼ãƒ•ã‚©ãƒ«ãƒ€IDï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
```

**ã“ã‚Œã‚‰ã®IDã¯Google Driveã®URLã‹ã‚‰å–å¾—ã—ã¾ã™:**

```
ä¾‹: https://drive.google.com/drive/folders/1NkwibbiUTzaznJGtF0kvsxFER3t62ZMx
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                            ã“ã‚ŒãŒãƒ•ã‚©ãƒ«ãƒ€ID
```

### 2. è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«

ã‚·ã‚¹ãƒ†ãƒ ãŒ**Google Driveã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã™ã‚‹è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«ï¼š

| ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ— | å½¢å¼ | ä¾‹ |
|--------------|------|-----|
| ç”»åƒ | JPEG, PNG, HEICç­‰ | ko62.jpg |
| æ–‡æ›¸ | PDF, Word, Excel | ko63.pdf, ko64.docx |
| ã‚¦ã‚§ãƒ– | HTML, MHTML | ko65.html |
| å‹•ç”» | MP4, MOVç­‰ | ko70_video.mp4 |
| éŸ³å£° | MP3, WAVç­‰ | ko71_audio.mp3 |

**ã‚·ã‚¹ãƒ†ãƒ ãŒGoogle Driveã‹ã‚‰å–å¾—ã™ã‚‹æƒ…å ±:**

```python
{
    "file_id": "1abc...xyz",              # Google Driveã®ãƒ•ã‚¡ã‚¤ãƒ«ID
    "file_name": "ko62.pdf",              # ãƒ•ã‚¡ã‚¤ãƒ«å
    "mime_type": "application/pdf",       # MIMEã‚¿ã‚¤ãƒ—
    "size": 1234567,                      # ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼ˆãƒã‚¤ãƒˆï¼‰
    "created_time": "2024-01-15T10:30:00", # ä½œæˆæ—¥æ™‚
    "modified_time": "2024-01-15T10:35:00", # å¤‰æ›´æ—¥æ™‚
    "web_view_link": "https://drive.google.com/file/d/1abc...xyz/view",
    "web_content_link": "https://drive.google.com/uc?id=1abc...xyz&export=download"
}
```

### 3. æ—¢å­˜ã®database.jsonï¼ˆå¾©å…ƒç”¨ï¼‰

Google Driveã«ä¿å­˜ã•ã‚ŒãŸæ—¢å­˜ã®`database.json`ã‚’èª­ã¿è¾¼ã‚“ã§ã€é€²æ—ã‚’å¾©å…ƒã—ã¾ã™ã€‚

---

## ğŸ“¤ å‡ºåŠ›æƒ…å ±ï¼ˆã‚·ã‚¹ãƒ†ãƒ  â†’ Google Driveï¼‰

### 1. database.jsonï¼ˆè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰

ã‚·ã‚¹ãƒ†ãƒ ãŒ**Google Driveã«ä¿å­˜**ã™ã‚‹åˆ†æçµæœï¼š

```json
{
  "case_info": {
    "case_name": "æèµ·å‰_åèª‰æ¯€æç­‰æå®³è³ å„Ÿè«‹æ±‚äº‹ä»¶",
    "plaintiff": "å°åŸç³ï¼ˆã—ã‚ãã¾ã‚¯ãƒ©ãƒ•ãƒˆï¼‰",
    "defendant": "çŸ³æ‘ã¾ã‚†ã‹ï¼ˆSUBÃ—MISSIONï¼‰",
    "court": "æ±äº¬åœ°æ–¹è£åˆ¤æ‰€"
  },
  "evidence": [
    {
      "evidence_number": "ko62",
      "complete_metadata": {
        "file_hash": { "sha256": "abc123..." },
        "google_drive_urls": {
          "web_view_link": "https://drive.google.com/file/d/xxx/view",
          "download_link": "https://drive.google.com/uc?id=xxx&export=download"
        }
      },
      "phase1_complete_analysis": { /* AIåˆ†æçµæœ */ },
      "status": "completed",
      "processed_at": "2025-10-19T12:34:56"
    }
  ]
}
```

**ä¿å­˜å…ˆ:**
- `{äº‹ä»¶ãƒ•ã‚©ãƒ«ãƒ€}/database.json`
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: `{äº‹ä»¶ãƒ•ã‚©ãƒ«ãƒ€}/database_backup_YYYYMMDD_HHMMSS.json`

### 2. Google Drive URLè¨˜éŒ²

å„è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«ã®Google Drive URLã‚’`database.json`ã«è¨˜éŒ²ï¼š

```json
{
  "google_drive_urls": {
    "file_id": "1abc...xyz",
    "web_view_link": "https://drive.google.com/file/d/1abc...xyz/view",
    "download_link": "https://drive.google.com/uc?id=1abc...xyz&export=download",
    "preview_link": "https://drive.google.com/file/d/1abc...xyz/preview"
  }
}
```

**ç”¨é€”:**
- Phase 2ä»¥é™ã§è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«ã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
- è¨¼æ‹ èª¬æ˜æ›¸ã«ç›´ãƒªãƒ³ã‚¯ã‚’è¨˜è¼‰
- è£åˆ¤æ‰€æå‡ºç”¨ã®URLç”Ÿæˆ

---

## ğŸ” èªè¨¼ã®ä»•çµ„ã¿

### ã‚¹ãƒ†ãƒƒãƒ—1: credentials.jsonï¼ˆåˆå›ã®ã¿ï¼‰

Google Cloud Consoleã‹ã‚‰å–å¾—ã™ã‚‹èªè¨¼æƒ…å ±ï¼š

```
credentials.json
â”œâ”€â”€ client_id: Google APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID
â”œâ”€â”€ client_secret: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ
â””â”€â”€ redirect_uris: ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURI
```

**å–å¾—æ–¹æ³•:**
1. Google Cloud Consoleï¼ˆhttps://console.cloud.google.com/ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
3. Google Drive APIã‚’æœ‰åŠ¹åŒ–
4. OAuth 2.0ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã‚’ä½œæˆï¼ˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªï¼‰
5. credentials.jsonã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

### ã‚¹ãƒ†ãƒƒãƒ—2: token.jsonï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰

åˆå›å®Ÿè¡Œæ™‚ã«è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼š

```
token.json
â”œâ”€â”€ access_token: çŸ­æœŸã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆ1æ™‚é–“æœ‰åŠ¹ï¼‰
â”œâ”€â”€ refresh_token: é•·æœŸãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³
â”œâ”€â”€ token_uri: ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°ç”¨URI
â””â”€â”€ expiry: ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™
```

**è‡ªå‹•æ›´æ–°:**
- `token.json`ã¯è‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œã¾ã™
- `refresh_token`ã‚’ä½¿ã£ã¦`access_token`ã‚’è‡ªå‹•æ›´æ–°
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å†èªè¨¼ä¸è¦

### ã‚¹ãƒ†ãƒƒãƒ—3: èªè¨¼ãƒ•ãƒ­ãƒ¼

```
åˆå›å®Ÿè¡Œ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ python3 run_phase1.pyâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“ credentials.jsonèª­ã¿è¾¼ã¿
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•èµ·å‹•   â”‚
â”‚ Googleãƒ­ã‚°ã‚¤ãƒ³ç”»é¢   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¨©é™ã®è¨±å¯           â”‚
â”‚ (Google Driveèª­ã¿æ›¸ã)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“ èªè¨¼å®Œäº†
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ token.jsonè‡ªå‹•ç”Ÿæˆ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2å›ç›®ä»¥é™:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ python3 run_phase1.pyâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“ token.jsonèª­ã¿è¾¼ã¿
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è‡ªå‹•ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆç„¡éŸ³ï¼‰  â”‚
â”‚ å†èªè¨¼ä¸è¦           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ï¼ˆè©³ç´°ï¼‰

### ãƒ•ãƒ­ãƒ¼1: è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«ã®å–å¾—

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¨¼æ‹ ç•ªå·ã‚’å…¥åŠ› (ä¾‹: ko62)
   â†“
2. ã‚·ã‚¹ãƒ†ãƒ ãŒGoogle Driveã§æ¤œç´¢
   - ãƒ•ã‚©ãƒ«ãƒ€ID: KO_EVIDENCE_FOLDER_ID
   - ãƒ•ã‚¡ã‚¤ãƒ«å: "ko62" ã§å§‹ã¾ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
   â†“
3. ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ã‚’å–å¾—
   - ãƒ•ã‚¡ã‚¤ãƒ«IDã€åå‰ã€ã‚µã‚¤ã‚ºã€ä½œæˆæ—¥æ™‚ç­‰
   â†“
4. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
   - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å…ˆ: /tmp/phase1_temp/ko62.pdf
   â†“
5. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
   - ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚·ãƒ¥ (SHA-256, MD5, SHA-1)
   - EXIFæƒ…å ± (ç”»åƒã®å ´åˆ)
   - æ–‡æ›¸ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ (PDF/Wordã®å ´åˆ)
   - Google Drive URL
   â†“
6. ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†
   - PDF â†’ ç”»åƒæŠ½å‡º
   - ç”»åƒ â†’ ãƒªã‚µã‚¤ã‚ºãƒ»æ­£è¦åŒ–
   - Word â†’ ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º
   â†“
7. AIåˆ†æ (GPT-4o Vision)
   - ç”»åƒãƒ»ãƒ†ã‚­ã‚¹ãƒˆã‚’åˆ†æ
   - å®Œå…¨è¨€èªåŒ–ãƒ¬ãƒ™ãƒ«4
   â†“
8. database.jsonã«ä¿å­˜
   - ãƒ­ãƒ¼ã‚«ãƒ«: ./database.json
   - Google Drive: {äº‹ä»¶ãƒ•ã‚©ãƒ«ãƒ€}/database.json (è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—)
```

### ãƒ•ãƒ­ãƒ¼2: database.jsonã®åŒæœŸ

```
èµ·å‹•æ™‚:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ­ãƒ¼ã‚«ãƒ«ã®database.jsonã‚’ç¢ºèª  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“ å­˜åœ¨ã™ã‚‹ï¼Ÿ
      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
      â”‚ YES     â”‚ NO
      â†“         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ èª­ã¿è¾¼ã¿ â”‚  â”‚ Google Driveã‹ã‚‰  â”‚
â”‚         â”‚  â”‚ database.jsonã‚’   â”‚
â”‚         â”‚  â”‚ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å¾©å…ƒâ”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ å‡¦ç†å®Ÿè¡Œ â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“ è¨¼æ‹ ã‚’å‡¦ç†
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ database.jsonã‚’æ›´æ–°â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“ è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Google Driveã«è‡ªå‹•ä¿å­˜     â”‚
    â”‚ - database.json (æœ€æ–°)     â”‚
    â”‚ - database_backup_*.json   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ 

### Google Driveä¸Šã®æ¨å¥¨æ§‹é€ 

```
å…±æœ‰ãƒ‰ãƒ©ã‚¤ãƒ–/ (ã¾ãŸã¯ ãƒã‚¤ãƒ‰ãƒ©ã‚¤ãƒ–/)
â””â”€â”€ äº‹ä»¶ãƒ•ã‚©ãƒ«ãƒ€/
    â”œâ”€â”€ ç”²å·è¨¼/
    â”‚   â”œâ”€â”€ ko62.pdf
    â”‚   â”œâ”€â”€ ko63.jpg
    â”‚   â”œâ”€â”€ ko64.docx
    â”‚   â”œâ”€â”€ ko65.html
    â”‚   â”œâ”€â”€ ko66.png
    â”‚   â”œâ”€â”€ ko67.pdf
    â”‚   â”œâ”€â”€ ko70_video1.mp4
    â”‚   â”œâ”€â”€ ko70_video2.mp4
    â”‚   â”œâ”€â”€ ko71.pdf
    â”‚   â”œâ”€â”€ ko72.jpg
    â”‚   â””â”€â”€ ko73.docx
    â”‚
    â”œâ”€â”€ ä¹™å·è¨¼/ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
    â”‚   â”œâ”€â”€ otsu1.pdf
    â”‚   â””â”€â”€ otsu2.jpg
    â”‚
    â”œâ”€â”€ database.json â† ã‚·ã‚¹ãƒ†ãƒ ãŒè‡ªå‹•ä¿å­˜
    â”œâ”€â”€ database_backup_20251019_120000.json
    â”œâ”€â”€ database_backup_20251019_130000.json
    â””â”€â”€ database_backup_20251019_140000.json
```

### ãƒ­ãƒ¼ã‚«ãƒ«PCä¸Šã®æ§‹é€ 

```
~/Documents/phase1_complete_system/
â”œâ”€â”€ config.py                     # Google Driveãƒ•ã‚©ãƒ«ãƒ€IDè¨­å®š
â”œâ”€â”€ credentials.json              # Googleèªè¨¼æƒ…å ±
â”œâ”€â”€ token.json                    # ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
â”œâ”€â”€ database.json                 # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
â”œâ”€â”€ phase1_complete.log           # ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«
â”‚
â”œâ”€â”€ run_phase1.py                 # å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ metadata_extractor.py
â”œâ”€â”€ file_processor.py
â”œâ”€â”€ ai_analyzer_complete.py
â””â”€â”€ ...
```

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### 1. èªè¨¼æƒ…å ±ã®ä¿è­·

**credentials.json:**
- âœ… ãƒ­ãƒ¼ã‚«ãƒ«PCã«ã®ã¿ä¿å­˜
- âœ… Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ï¼ˆ.gitignoreã«è¿½åŠ ï¼‰
- âœ… æ¨©é™: èª­ã¿å–ã‚Šå°‚ç”¨ã«è¨­å®š

**token.json:**
- âœ… è‡ªå‹•ç”Ÿæˆãƒ»è‡ªå‹•æ›´æ–°
- âœ… ãƒ­ãƒ¼ã‚«ãƒ«PCã«ã®ã¿ä¿å­˜
- âœ… æœ‰åŠ¹æœŸé™: access_tokenã¯1æ™‚é–“ã€refresh_tokenã¯é•·æœŸ

### 2. Google Driveæ¨©é™

ã‚·ã‚¹ãƒ†ãƒ ãŒè¦æ±‚ã™ã‚‹æ¨©é™ï¼š

```
https://www.googleapis.com/auth/drive
```

**ã§ãã‚‹ã“ã¨:**
- âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿å–ã‚Š
- âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- âœ… database.jsonã®ä¿å­˜ãƒ»æ›´æ–°

**ã§ããªã„ã“ã¨:**
- âŒ ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤ï¼ˆè¨­å®šæ¬¡ç¬¬ã§å¯èƒ½ã ãŒã€æ¨å¥¨ã—ãªã„ï¼‰
- âŒ å…±æœ‰è¨­å®šã®å¤‰æ›´
- âŒ ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ä»˜ä¸

### 3. ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–

**è»¢é€æ™‚:**
- âœ… HTTPSé€šä¿¡ï¼ˆTLS 1.2ä»¥ä¸Šï¼‰
- âœ… Google Drive APIã¯ã™ã¹ã¦æš—å·åŒ–é€šä¿¡

**ä¿å­˜æ™‚:**
- âœ… Google Driveä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯è‡ªå‹•çš„ã«æš—å·åŒ–
- âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã®database.jsonã¯å¹³æ–‡ï¼ˆå¿…è¦ã«å¿œã˜ã¦æš—å·åŒ–å¯èƒ½ï¼‰

---

## ğŸ” Google Driveæ“ä½œã®è©³ç´°

### æ“ä½œ1: ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢

```python
# ç”²å·è¨¼ãƒ•ã‚©ãƒ«ãƒ€å†…ã§ko62ã‚’æ¤œç´¢
query = f"'{KO_EVIDENCE_FOLDER_ID}' in parents and name contains 'ko62'"
results = drive_service.files().list(
    q=query,
    fields="files(id, name, mimeType, size, createdTime, modifiedTime, webViewLink, webContentLink)",
    supportsAllDrives=True
).execute()

# çµæœä¾‹:
# {
#   "files": [
#     {
#       "id": "1abc...xyz",
#       "name": "ko62.pdf",
#       "mimeType": "application/pdf",
#       "size": "1234567",
#       "createdTime": "2024-01-15T10:30:00.000Z",
#       "modifiedTime": "2024-01-15T10:35:00.000Z",
#       "webViewLink": "https://drive.google.com/file/d/1abc...xyz/view",
#       "webContentLink": "https://drive.google.com/uc?id=1abc...xyz&export=download"
#     }
#   ]
# }
```

### æ“ä½œ2: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```python
# ãƒ•ã‚¡ã‚¤ãƒ«IDã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
file_id = "1abc...xyz"
request = drive_service.files().get_media(fileId=file_id)

# ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜
with open("/tmp/ko62.pdf", "wb") as f:
    downloader = MediaIoBaseDownload(f, request)
    done = False
    while not done:
        status, done = downloader.next_chunk()
        print(f"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é€²æ—: {int(status.progress() * 100)}%")
```

### æ“ä½œ3: database.jsonä¿å­˜

```python
# database.jsonã‚’Google Driveã«ä¿å­˜
file_metadata = {
    'name': 'database.json',
    'parents': [CASE_FOLDER_ID]
}

media = MediaFileUpload(
    'database.json',
    mimetype='application/json',
    resumable=True
)

# æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Œã°æ›´æ–°ã€ãªã‘ã‚Œã°æ–°è¦ä½œæˆ
if existing_file_id:
    drive_service.files().update(
        fileId=existing_file_id,
        media_body=media
    ).execute()
else:
    drive_service.files().create(
        body=file_metadata,
        media_body=media,
        fields='id'
    ).execute()
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œï¼ˆã¾ã¨ã‚ï¼‰

### å…¥åŠ›ãƒ‡ãƒ¼ã‚¿

| é …ç›® | å ´æ‰€ | å†…å®¹ |
|------|------|------|
| **è¨­å®šæƒ…å ±** | config.py | ãƒ•ã‚©ãƒ«ãƒ€IDã€èªè¨¼æƒ…å ± |
| **è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«** | Google Drive | PDF, ç”»åƒ, å‹•ç”», éŸ³å£°ç­‰ |
| **æ—¢å­˜DB** | Google Drive | database.jsonï¼ˆå¾©å…ƒç”¨ï¼‰ |

### å‡¦ç†ãƒ‡ãƒ¼ã‚¿

| é …ç›® | å ´æ‰€ | å†…å®¹ |
|------|------|------|
| **ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰** | /tmp/ | ä¸€æ™‚çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ |
| **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿** | ãƒ¡ãƒ¢ãƒª | ãƒãƒƒã‚·ãƒ¥ã€EXIFã€URLç­‰ |
| **AIåˆ†æ** | ãƒ¡ãƒ¢ãƒª | GPT-4o Visionåˆ†æçµæœ |

### å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿

| é …ç›® | å ´æ‰€ | å†…å®¹ |
|------|------|------|
| **database.json** | ãƒ­ãƒ¼ã‚«ãƒ«PC | å®Œå…¨åˆ†æçµæœ |
| **database.json** | Google Drive | è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— |
| **ãƒ­ã‚°** | ãƒ­ãƒ¼ã‚«ãƒ«PC | å‡¦ç†ãƒ­ã‚° |

---

## ğŸ’¡ å®Ÿè£…ä¾‹

### ä¾‹1: Google Driveã‹ã‚‰è¨¼æ‹ ã‚’æ¤œç´¢

```python
from googleapiclient.discovery import build
from google.oauth2.credentials import Credentials

# èªè¨¼
creds = Credentials.from_authorized_user_file('token.json')
service = build('drive', 'v3', credentials=creds)

# ko62ã‚’æ¤œç´¢
query = f"'{KO_EVIDENCE_FOLDER_ID}' in parents and name contains 'ko62'"
results = service.files().list(q=query, fields="files(id, name)").execute()

print(f"æ¤œå‡ºã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«: {results['files']}")
# å‡ºåŠ›: [{'id': '1abc...xyz', 'name': 'ko62.pdf'}]
```

### ä¾‹2: ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```python
from googleapiclient.http import MediaIoBaseDownload

file_id = "1abc...xyz"
request = service.files().get_media(fileId=file_id)

with open("ko62.pdf", "wb") as f:
    downloader = MediaIoBaseDownload(f, request)
    done = False
    while not done:
        status, done = downloader.next_chunk()

print("âœ… ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†")
```

### ä¾‹3: database.jsonã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

```python
from googleapiclient.http import MediaFileUpload

file_metadata = {'name': 'database.json', 'parents': [CASE_FOLDER_ID]}
media = MediaFileUpload('database.json', mimetype='application/json')

file = service.files().create(
    body=file_metadata,
    media_body=media,
    fields='id'
).execute()

print(f"âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†: {file['id']}")
```

---

## ğŸ“ ã¾ã¨ã‚

### Google Driveé€£æºã®è¦ç‚¹

1. **å…¥åŠ›:**
   - è¨­å®šæƒ…å ±ï¼ˆãƒ•ã‚©ãƒ«ãƒ€IDï¼‰
   - è¨¼æ‹ ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆPDF, ç”»åƒ, å‹•ç”», éŸ³å£°ç­‰ï¼‰
   - æ—¢å­˜ã®database.jsonï¼ˆå¾©å…ƒç”¨ï¼‰

2. **å‡¦ç†:**
   - ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
   - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºãƒ»AIåˆ†æ
   - database.jsonä½œæˆ

3. **å‡ºåŠ›:**
   - database.jsonï¼ˆãƒ­ãƒ¼ã‚«ãƒ« + Google Driveè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰
   - Google Drive URLè¨˜éŒ²

4. **èªè¨¼:**
   - credentials.jsonï¼ˆåˆå›ã®ã¿ï¼‰
   - token.jsonï¼ˆè‡ªå‹•ç”Ÿæˆãƒ»è‡ªå‹•æ›´æ–°ï¼‰

5. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£:**
   - HTTPSæš—å·åŒ–é€šä¿¡
   - OAuth 2.0èªè¨¼
   - æœ€å°æ¨©é™ã®åŸå‰‡

---

**æœ€çµ‚æ›´æ–°:** 2025-10-19  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** 3.2  
**å¯¾å¿œ:** Google Drive API v3
